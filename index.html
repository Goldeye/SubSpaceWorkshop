<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>SubSpace Workshop</title>

    <script type="module">

        let overrideTilemapShader = () => {

            let fragmentShader = [
                "varying vec2 vTextureCoord;" +
                "varying vec4 vFrame;" +
                "varying float vTextureId;" +
                "uniform vec4 shadowColor;" +
                "uniform sampler2D uSamplers[%count%];" +
                "uniform vec2 uSamplerSize[%count%];" +
                "void main(void){" +
                "   vec2 textureCoord = clamp(vTextureCoord, vFrame.xy, vFrame.zw);" +
                "   float textureId = floor(vTextureId + 0.5);" +
                "   vec4 color;" +
                "   %forloop%" +
                "   if(color.r == 0.0 && color.g == 0.0 && color.b == 0.0){" +
                "       discard;" +
                "   }" +
                "   gl_FragColor = color;" +
                "}"
            ].join("\n");

            PIXI.tilemap.shaderGenerator.generateFragmentSrc = (maxTextures, fragmentSrc) => {
                return fragmentShader.replace(/%count%/gi, maxTextures + "")
                    .replace(/%forloop%/gi, PIXI.tilemap.shaderGenerator.generateSampleSrc(maxTextures));
            };

        };

        // JS libraries.
        // const fs = require('fs');
        const remote = require('electron');
        const THREE = window.THREE = require('three');
        // const customTitlebar = require('custom-electron-titlebar');
        const stats = require("stats.js");
        const uuid = require('uuid');

        const PIXI = window.PIXI = require("pixi.js");
        require("pixi-tilemap");

        overrideTilemapShader();

        window.$ = window.jQuery = require('jquery');

        // Project JS files.
        const main = require("./assets/js/main.js");

        $(function () {
            // Start application.
            main.start();
        });

    </script>

    <link rel="stylesheet" href="assets/css/project.min.css"/>
</head>
<body>

<div class="editor_frame dark">

    <div class="viewport-frame">

        <div id="editor-tab-menu" class="tab-menu">
            <div class="tab"><label>Map</label></div>
            <div class="tab selected"><label>Library</label></div>
        </div>

        <!-- The PixiJS canvas goes in here. -->
        <div id="map-viewer-container" style="display: block">
            <div id="editor-left-tab-menu" class="tab-menu left">
                <div class="tab selected"><label>Tileset</label></div>
                <div class="tab"><label>LVZ</label></div>
                <div class="tab"><label>Regions</label></div>
            </div>
            <div class="workspace-tileset">
                <canvas id="tileset" class="tileset" width="304" height="160"></canvas>
                <div id="tileset-primary" class="tile-selector primary"></div>
                <div id="tileset-secondary" class="tile-selector secondary"></div>
            </div>
            <div class="workspace-radar">
                <canvas id="radar" class="radar" width="256" height="256"></canvas>
            </div>
        </div>

    </div>
</div>



</body>
</html>
